==582==ERROR: AddressSanitizer: heap-use-after-free on address 0x61500000feb8 at pc 0x00000042a244 bp 0x7f8664b98d90 sp 0x7f8664b98d80
READ of size 8 at 0x61500000feb8 thread T10
    #0 0x42a243 in lzma_decompress_buf ../stream.c:564
    #1 0x43170b in ucompthread ../stream.c:1522
    #2 0x7f890138b6b9 in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76b9)
    #3 0x7f89007bd4dc in clone (/lib/x86_64-linux-gnu/libc.so.6+0x1074dc)

0x61500000feb8 is located 440 bytes inside of 480-byte region [0x61500000fd00,0x61500000fee0)
freed by thread T0 here:
    #0 0x7f8901c8532a in __interceptor_free (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x9832a)
    #1 0x43477b in close_stream_in ../stream.c:1839
    #2 0x4248b9 in runzip_chunk ../runzip.c:361
    #3 0x424bcb in runzip_fd ../runzip.c:382
    #4 0x411746 in decompress_file ../lrzip.c:826
    #5 0x409cde in main ../main.c:669
    #6 0x7f89006d683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

previously allocated by thread T0 here:
    #0 0x7f8901c857fa in __interceptor_calloc (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x987fa)
    #1 0x42d615 in open_stream_in ../stream.c:1082
    #2 0x4241f0 in runzip_chunk ../runzip.c:304
    #3 0x424bcb in runzip_fd ../runzip.c:382
    #4 0x411746 in decompress_file ../lrzip.c:826
    #5 0x409cde in main ../main.c:669
    #6 0x7f89006d683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

Thread T10 created by T0 here:
    #0 0x7f8901c231e3 in pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.2+0x361e3)
    #1 0x426fa5 in create_pthread ../stream.c:133
    #2 0x432f12 in fill_buffer ../stream.c:1673
    #3 0x433d0b in read_stream ../stream.c:1755
    #4 0x423268 in unzip_literal ../runzip.c:162
    #5 0x4243ca in runzip_chunk ../runzip.c:320
    #6 0x424bcb in runzip_fd ../runzip.c:382
    #7 0x411746 in decompress_file ../lrzip.c:826
    #8 0x409cde in main ../main.c:669
    #9 0x7f89006d683f in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2083f)

SUMMARY: AddressSanitizer: heap-use-after-free ../stream.c:564 lzma_decompress_buf
Shadow bytes around the buggy address:
  0x0c2a7fff9f80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff9f90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff9fa0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c2a7fff9fb0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c2a7fff9fc0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
=>0x0c2a7fff9fd0: fd fd fd fd fd fd fd[fd]fd fd fd fd fa fa fa fa
  0x0c2a7fff9fe0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fff9ff0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fffa000: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fffa010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c2a7fffa020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Heap right redzone:      fb
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack partial redzone:   f4
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
==582==ABORTING
